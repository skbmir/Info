# **Установка ROS Kinetic**

http://wiki.ros.org - справка по ROS

---------------------------------
## **Добавление репозитория ROS**

1. Добавляем ссылку на репозиторий в список репозиториев системы

```
sudo sh -c 'echo "deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main" > /etc/apt/sources.list.d/ros-latest.list'
```

2. Добавляем ключ репозитория, чтобы система поняла, что репозиторию можно доверять

```
sudo apt-key adv --keyserver 'hkp://keyserver.ubuntu.com:80' --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654
```

Если в процессе добавления ключа возникнет проблема вроде:

```
gpg: не найдено данных формата OpenPGP.
gpg: Всего обработано: 0
gpg: ошибка связи с сервером ключей: keyserver unreachable
gpg: ошибка связи с сервером ключей: открытый ключ не найден
gpg: сбой при получении с сервера ключей: открытый ключ не найден
```

можно использовать:

```
curl -sSL 'http://keyserver.ubuntu.com/pks/lookup?op=get&search=0xC1CF6E31E6BADE8868B172B4F42ED6FBAB17C654' | sudo apt-key add -
```

3. Обновляем список пакетов

```
sudo apt update
```

--------------------
## **Установка ROS**

ROS предлагает заготовленные наборы ПО для установки:
- desktop-full - включает большое кол-во нод, симуляторы, средства визуализации и т.п.
- desktop - общий набор нод и средств визуализации
- ros-base - только необходимое ПО для работы ROS, остальное устанавливается по необходимости

Если вы собираетесь работать и с ROS ис компьютерным зрением имейте в виду, что при установке desktop-full или desktop будет установлена версия OpenCV, предоставляемая ROS это версия 3.3.1 без дополнительных и несвободных модулей (например SIFT и SURF) и, возможно, без поддержки CUDA (но OpenCL должен быть). В случае, если обязательно нужна поддержка CUDA в OpenCV лучшим вариантом будет ros-base, он не включает в себя OpenCV и это позволит самостоятельно без проблем установить нужную версию OpenCV.

Установка:

```
sudo apt install ros-melodic-desktop-full
```

или

```
sudo apt install ros-melodic-desktop
```

или

```
sudo apt install ros-melodic-ros-base
```

-----------
## **Настройка ROS**

1. Инициализация утилиты rosdep для установки зависимостей, нужных для компиляции программ

```
sudo rosdep init
      
rosdep update
```

2. Настройка окружающей среды, чтобы различные утилиты ROS и ноды можно было запускать из терминала

```
echo "source /opt/ros/melodic/setup.bash" >> ~/.bashrc

source ~/.bashrc
```

3. Установка утилит для сборки пакетов ROS

```
sudo apt install python-rosinstall python-rosinstall-generator python-wstools build-essential
```

-----------------------------
## **Создание вашего рабочего пространства**

Рабочее пространство представляет собой папку, в которой будут храниться разработанные вами пакеты для ROS и сторонние пакеты, например, загруженные с github.com. Компиляция пакетов в ROS производится автоматически с помощью утилиты Catkin.

Создание папки для рабочего пространства в домашнем каталоге пользователя (/home/имя_пользователя)

```
cd ~/ # Перейти в домашнюю папку вашего пользователя

mkdir -p catkin_ws/src # Создать папку src в папке catkin_ws
```

mkdir - команда создания папки, флаг -p указывает, что необходимо создать директорию src и все родительские директории (т.е. директорию catkin_ws) если они не существуют. Без этого флага будет выведена ошибка о несуществующем каталоге catkin_ws.

Папка catkin_ws является основной папкой вашего рабочего пространства.

В папке src хранятся исходные коды пакетов ROS созданных вами или сторонних пакетов.

Прейдем в созданную папку

```
cd catkin_ws
```

Выполним инициализацию рабочего места

```
catkin_make
```

После этого для последующей компиляции всех пакетов необходимо будет перейти в папку с вашим рабочи местом и запустить команду catkin_make.

```
cd ~/catkin_ws

catkin_make
```

Чтобы иметь возможность запускать ноды из пакетов, находящихся в вашем рабочем пространстве необходимо указать ROS, где их найти.

```
cd ~/catkin_ws

source devel/setup.bash
```

Это позволить запустить нужные ноды только из текущего терминала.

По желанию можно сделать так, чтобы данная операция выполнялась каждый раз когда вы открываете терминал.

! Вместо имя_пользователя необходимо подставить имя своего пользователя

```
echo "source /home/имя_пользователя/catkin_ws/devel/setup.bash" >> ~/.bashrc
```